class SeedAdmCodeHeadersFromMasterList < ActiveRecord::Migration[8.1]
  class MigrationAdmCodeHeader < ApplicationRecord
    self.table_name = "adm_code_headers"
  end

  RAW_MASTER_DATA = <<~TEXT
    01
    세관신고용 컨테이너TYPE
    50
    02
    세관신고용 컨테이너SIZE
    50
    03
    거래처구분그룹
    50
    04
    거래처구분
    50
    05
    거래처종류
    50
    06
    사용여부
    10
    07
    작업단계Level1
    50
    08
    작업단계Level2
    50
    09
    작업경로 화물종류(화종)
    50
    10
    작업유형1(물류영역)
    50
    11
    작업유형2(물류기능)
    50
    12
    하태
    50
    13
    품목군
    50
    14
    품목
    50
    15
    화종
    50
    16
    화종군
    50
    17
    품명관리 구분
    50
    18
    매출입구분
    40
    19
    길이단위코드
    50
    20
    기본단위분류코드
    50
    21
    수량단위코드
    50
    22
    온도단위코드
    50
    23
    부피단위코드
    50
    24
    중량단위코드
    50
    25
    시스템 구분
    50
    26
    공시차수
    50
    27
    화폐코드
    50
    28
    결재유형코드
    50
    29
    거래처관련이력테이블
    50
    30
    권한유형코드
    50
    31
    계역종류
    50
    32
    반품여부
    10
    33
    시스템설정대분류
    10
    34
    시스템설정단위
    10
    35
    계산서취소구분
    40
    36
    시스템설정구분
    10
    37
    시스템설정소분류
    10
    38
    시스템설정중분류
    10
    39
    오더검증오류코드
    10
    40
    시스템설정메시지
    10
    41
    시스템적용일자
    10
    42
    상하차구분
    20
    43
    고객거래처관련이력테이블
    50
    44
    계약관련이력테이블
    50
    45
    선적형태
    50
    46
    운임결재방식
    50
    48
    Order Type
    50
    49
    운임코드그룹
    50
    50
    세관과코드
    50
    51
    운임구분
    20
    52
    청구유형
    40
    53
    계산서구분
    40
    54
    청구서구분
    40
    55
    매출확정구분
    40
    56
    피킹상태코드
    30
    57
    청구구분
    40
    58
    정산관리번호구분
    40
    59
    협력사확인구분
    40
    60
    매입승인구분
    40
    61
    차대변구분
    40
    62
    청구거래처유형
    40
    63
    반올림구분코드
    40
    64
    금액처리단위구분
    40
    65
    청구방법구분
    40
    66
    실적인식구분
    40
    67
    청구인식기준
    40
    68
    창고정산상태코드
    40
    69
    매출입아이템유형
    40
    70
    거래명세서확정구분
    40
    71
    예외오더서비스유형
    40
    72
    청구일구분
    40
    73
    청구시작월구분
    40
    74
    요율적용구분
    40
    75
    출도착지유형코드
    10
    76
    오더상태코드
    10
    77
    전송구분코드
    10
    78
    화물형태코드
    10
    79
    오더종류코드
    10
    80
    수출수입내수
    10
    81
    운송구분
    10
    82
    입출고구분
    10
    83
    고객오더접수채널코드
    10
    84
    확정구분코드
    10
    85
    실행실적구분코드
    10
    86
    오더완료구분코드
    10
    87
    오더사유코드
    10
    89
    작업정보관리유형코드
    10
    90
    작업진행구분코드
    10
    91
    오더일자구분
    10
    92
    작업장구분코드
    50
    93
    전체레벨
    50
    94
    공통비구분코드
    50
    95
    직위 구분
    50
    96
    재직상태코드
    50
    97
    직책 구분
    50
    98
    시스템언어선택
    50
    99
    결재상태
    50
    100
    사용자구분
    20
    101
    재고속성구분
    30
    102
    로케이션구분
    30
    103
    생성결과
    10
    104
    소유구분
    20
    105
    차량규격
    20
    106
    RULE구분코드
    30
    107
    가용여부
    20
    108
    운송형태
    30
    109
    거래처분류
    20
    110
    작업구간
    20
    111
    운송조건
    20
    112
    중량조건
    20
    113
    실행실적타입
    30
    114
    작업상태
    20
    115
    Shift구분
    20
    116
    전송상태
    20
    117
    할인할증코드
    20
    118
    거래명세서유형
    20
    119
    확정구분
    20
    120
    로케이션유형
    30
    121
    범위구분
    20
    122
    시간단위구분
    20
    123
    배차상태
    20
    124
    차량비가용사유구분
    20
    125
    사고구분
    20
    126
    긴급구분
    20
    127
    차량종류
    20
    128
    출도착방법
    20
    129
    할인할증구분
    20
    130
    사고상태
    20
    131
    부가세구분
    20
    132
    피킹방법
    30
    133
    계약요율상태
    20
    134
    매입수량단위
    20
    135
    매출계약요율적용단위
    20
    136
    생성유형
    20
    137
    배차구분
    20
    138
    로드생성기준항목
    20
    139
    국제지역코드
    50
    140
    산업군코드
    50
    141
    지급조건코드
    50
    142
    결제유형코드
    50
    143
    결제방법코드
    50
    144
    계약구분코드
    50
    145
    계약해지사유코드
    50
    146
    진행상태코드
    50
    147
    환율적용환산기준
    50
    148
    인터페이스방식
    50
    149
    작업주기
    50
    150
    프로그램구분
    50
    151
    중요도/난이도 구분
    50
    152
    입고유형코드
    30
    153
    입고상태코드
    30
    154
    출고유형코드
    30
    155
    출고상태코드
    30
    156
    영업소구분
    20
    157
    계정과목
    50
    158
    성별구분
    50
    159
    시간코드
    20
    160
    매출입발생기준
    20
    161
    매출입요율기준
    20
    162
    오더구분코드
    10
    163
    송수신구분
    50
    164
    작업단계상태코드
    10
    165
    매입확정구분
    40
    166
    차대변계정명
    40
    167
    자동여부
    10
    168
    사업자여부
    50
    169
    장비제원
    20
    170
    장비종류
    20
    171
    장비관리구분
    20
    172
    미연계승인구분
    40
    173
    배차계획기준
    20
    174
    고객구분
    50
    175
    거리단위코드
    20
    176
    매입확정구분
    40
    177
    품명아이템구분
    20
    178
    배차번호구분
    20
    179
    비밀번호변경주기
    50
    180
    증빙구분
    40
    181
    작업단계
    10
    182
    출발구분
    20
    184
    세금계산서생성구분코드
    40
    185
    출도착지유형체크
    10
  TEXT

  def up
    rows.each do |row|
      header = MigrationAdmCodeHeader.find_or_initialize_by(code: row[:code])
      header.code_name = row[:code_name]
      header.sys_sctn_cd = row[:sys_sctn_cd]
      if header.new_record?
        header.use_yn = "Y"
      end
      header.save!
    end
  end

  def down
    MigrationAdmCodeHeader.where(code: rows.map { |row| row[:code] }).delete_all
  end

  private
    def rows
      values = RAW_MASTER_DATA.lines.map(&:strip).reject(&:empty?)
      if (values.length % 3).positive?
        raise "RAW_MASTER_DATA must be grouped by 3 lines (code/code_name/sys_sctn_cd)"
      end

      values.each_slice(3).map do |code, code_name, sys_sctn_cd|
        {
          code: code,
          code_name: code_name,
          sys_sctn_cd: sys_sctn_cd
        }
      end
    end
end
