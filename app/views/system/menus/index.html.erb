<%= turbo_frame_tag "main-content" do %>
  <div data-controller="menu-crud"
       data-menu-crud-create-url-value="<%= system_menus_path %>"
       data-menu-crud-update-url-value="<%= system_menu_path(':id') %>"
       data-menu-crud-delete-url-value="<%= system_menu_path(':id') %>">   
    <%= search_form_tag(
      url: system_menus_path,
      fields: [
        { field: "menu_cd", type: "input", label: "메뉴코드", placeholder: "메뉴코드 검색..." },
        { field: "menu_nm", type: "input", label: "메뉴명", placeholder: "메뉴명 검색..." },
        { field: "use_yn", type: "select", label: "사용여부",
          options: [
            { label: "전체", value: "" },
            { label: "사용", value: "Y" },
            { label: "미사용", value: "N" }
          ],
          include_blank: false
        }
      ],
      cols: 3,
      enable_collapse: true
    ) %>

    <div class="grid-toolbar">
      <div class="grid-toolbar-buttons">
        <button type="button" class="btn btn-sm btn-primary"
                data-action="click->menu-crud#openAddTopLevel">
          최상위 메뉴 추가
        </button>
      </div>
    </div>

    <%= ag_grid_tag(
      columns: [
        { field: "menu_nm", headerName: "메뉴명", minWidth: 250, cellRenderer: "treeMenuCellRenderer" },
        { field: "menu_cd", headerName: "메뉴코드", minWidth: 120 },
        { field: "menu_url", headerName: "URL", minWidth: 150 },
        { field: "sort_order", headerName: "정렬", maxWidth: 80 },
        { field: "menu_type", headerName: "타입", maxWidth: 100 },
        { field: "use_yn", headerName: "사용", maxWidth: 70 },
        { field: "tab_id", headerName: "탭ID", minWidth: 120 },
        { field: "actions", headerName: "작업", minWidth: 130, maxWidth: 130, filter: false, sortable: false, cellRenderer: "actionCellRenderer" }
      ],
      url: system_menus_path(format: :json),
      height: "calc(100vh - 370px)",
      page_size: 20
    ) %>

    <%= render "system/menus/form_modal" %>
  </div>
<% end %>
