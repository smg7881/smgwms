<header class="h-[var(--spacing-header)] bg-bg-secondary border-b border-border flex items-center px-5 shrink-0">
  <button class="inline-flex items-center justify-center bg-transparent border-none text-text-secondary cursor-pointer py-1 px-2 rounded-md leading-none shrink-0 mr-2 hover:bg-bg-hover hover:text-text-primary transition-[background,color] duration-150" type="button"
          data-action="click->tabs#toggleSidebar"
          aria-label="사이드바 열기/닫기">
    <%= lucide_icon("chevrons-left", css_class: "toggle-icon-collapse") %>
    <%= lucide_icon("chevrons-right", css_class: "toggle-icon-expand") %>
  </button>
  <div class="flex items-center gap-1.5 text-sm text-text-secondary">
    <%= lucide_icon("house", css_class: "w-4 h-4 text-text-secondary") %>
    <span class="text-text-muted">/</span>
    <span id="breadcrumb-current" class="flex items-center gap-0">
      <% active_id = session[:active_tab] || "overview" %>
      <% active_tab = (session[:open_tabs] || []).find { |t| t["id"] == active_id } %>
      <% base_label = active_tab&.dig("label") || TabRegistry.find(active_id)&.label || "대시보드" %>
      <% breadcrumbs = [] %>
      <% if defined?(AdmMenu) && AdmMenu.table_exists? %>
        <% current_menu = AdmMenu.find_by(tab_id: active_id) %>
        <% while current_menu %>
          <% breadcrumbs.unshift(current_menu.menu_nm) %>
          <% current_menu = current_menu.parent %>
        <% end %>
      <% end %>
      <% breadcrumbs = [base_label] if breadcrumbs.empty? %>
      
      <% breadcrumbs.each_with_index do |crumb, index| %>
        <% if index == breadcrumbs.length - 1 %>
          <span class="text-text-primary font-semibold"><%= crumb %></span>
        <% else %>
          <span class="text-text-secondary"><%= crumb %></span><span class="text-text-muted ml-0.5 mr-0.5">/</span>
        <% end %>
      <% end %>
    </span>
  </div>
  <div class="flex items-center gap-2 ml-auto">
    <div class="flex items-center gap-1.5 bg-bg-primary border border-border rounded-md px-2.5 py-1.5 text-[13px] text-text-secondary">
      <%= lucide_icon("search") %>
      <input type="text" placeholder="검색... (⌘K)"
             class="bg-transparent border-none outline-none text-text-primary text-[13px] w-40 placeholder:text-text-muted">
    </div>
    <button class="inline-flex items-center justify-center bg-transparent border border-border rounded-md px-2 py-1.5 cursor-pointer text-text-secondary leading-none hover:bg-bg-hover transition-colors duration-150" type="button" aria-label="알림">
      <%= lucide_icon("bell", css_class: "w-4 h-4") %>
    </button>
    <button class="inline-flex items-center justify-center bg-transparent border border-border rounded-md px-2 py-1.5 cursor-pointer text-text-secondary leading-none hover:bg-bg-hover transition-colors duration-150" type="button" aria-label="설정">
      <%= lucide_icon("settings", css_class: "w-4 h-4") %>
    </button>
    <%= button_to session_path, method: :delete, class: "inline-flex items-center justify-center bg-transparent border border-border rounded-md px-2 py-1.5 cursor-pointer text-text-secondary leading-none hover:bg-bg-hover transition-colors duration-150", form: { style: "display: contents" } do %>
      <%= lucide_icon("log-out", css_class: "w-4 h-4") %>
    <% end %>
  </div>
</header>
