<div class="relative flex items-stretch h-[var(--spacing-tab-bar)]">
  <div class="tab-bar-inner flex-1 flex items-stretch overflow-x-auto px-1">
    <% (tabs || []).each do |tab| %>
      <% tab_id = tab["id"] %>
      <% is_active = (tab_id == active) %>
      <% is_pinned = (tab_id == "overview") %>
      <% label = tab["label"] %>

      <button class="tab-item <%= "active" if is_active %> <%= "pinned" if is_pinned %>"
              type="button"
              title="<%= is_pinned ? "고정 탭" : label %>"
              data-action="click->tabs#activateTab contextmenu->tabs#openContextMenu"
              data-tab-id="<%= tab_id %>"
              data-tab-label="<%= label %>">
        <span class="w-[7px] h-[7px] rounded-full shrink-0 bg-text-muted transition-colors duration-150 <%= "bg-accent!" if is_active %>"></span>
        <%= label %>

        <% if is_pinned %>
          <span class="tab-pin" aria-hidden="true">
            <%= lucide_icon("pin", css_class: "w-3 h-3") %>
          </span>
        <% else %>
          <span class="ml-1 text-text-muted w-4 h-4 inline-flex items-center justify-center p-0 rounded-sm cursor-pointer hover:bg-accent-rose hover:text-white transition-[background,color] duration-150"
                data-action="click->tabs#closeTab:stop"
                data-tab-id="<%= tab_id %>">
            <%= lucide_icon("x", css_class: "w-3 h-3") %>
          </span>
        <% end %>
      </button>
    <% end %>
  </div>

  <div class="tab-actions shrink-0 border-l border-border flex items-center">
    <button type="button"
            class="tab-actions-trigger"
            aria-label="탭 메뉴"
            data-tabs-target="menuToggle"
            data-action="click->tabs#openActionsMenu">
      <%= lucide_icon("more-horizontal", css_class: "w-4 h-4") %>
    </button>

    <div class="tab-context-menu"
         role="menu"
         hidden
         data-tabs-target="contextMenu">
      <div class="tab-context-menu__item"
           role="menuitem"
           tabindex="0"
           data-menu-action="close-all"
           data-action="click->tabs#closeAllTabs keydown->tabs#handleMenuItemKeydown">
        <span class="tab-context-menu__icon"><%= lucide_icon("x", css_class: "w-3.5 h-3.5") %></span>
        <span>모두 닫기</span>
      </div>
      <div class="tab-context-menu__item"
           role="menuitem"
           tabindex="0"
           data-menu-action="close-others"
           data-action="click->tabs#closeOtherTabs keydown->tabs#handleMenuItemKeydown">
        <span class="tab-context-menu__icon"><%= lucide_icon("circle-off", css_class: "w-3.5 h-3.5") %></span>
        <span>현재 탭 제외 닫기</span>
      </div>
      <div class="tab-context-menu__divider"></div>
      <div class="tab-context-menu__item"
           role="menuitem"
           tabindex="0"
           data-menu-action="move-left"
           data-action="click->tabs#moveTabLeft keydown->tabs#handleMenuItemKeydown">
        <span class="tab-context-menu__icon"><%= lucide_icon("arrow-left-to-line", css_class: "w-3.5 h-3.5") %></span>
        <span>왼쪽이동</span>
      </div>
      <div class="tab-context-menu__item"
           role="menuitem"
           tabindex="0"
           data-menu-action="move-right"
           data-action="click->tabs#moveTabRight keydown->tabs#handleMenuItemKeydown">
        <span class="tab-context-menu__icon"><%= lucide_icon("arrow-right-to-line", css_class: "w-3.5 h-3.5") %></span>
        <span>오른쪽이동</span>
      </div>
    </div>
  </div>
</div>
