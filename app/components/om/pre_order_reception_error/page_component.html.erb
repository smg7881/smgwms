<div data-controller="om-pre-order-reception-error"
     data-om-pre-order-reception-error-reprocess-url-value="<%= reprocess_url %>"
     data-om-pre-order-reception-error-items-url-value="<%= items_url %>"
     data-om-pre-order-reception-error-download-url-value="<%= download_template_url %>"
     data-om-pre-order-reception-error-upload-url-value="<%= upload_template_url %>">
  <%= render Ui::ResourceFormComponent.new(
    model: search_form,
    fields: search_fields,
    url: create_url,
    method: :get,
    cols: 4,
    submit_label: "조회",
    form_html: { class: "om-pre-order-reception-error-search", novalidate: true }
  ) %>

  <section class="mb-5">
    <div class="flex items-center justify-between gap-3 mb-3 mt-2">
      <h3 class="inline-flex items-center gap-2 text-[15px] font-semibold text-text-primary">
        <%= helpers.lucide_icon("triangle-alert", css_class: "w-4 h-4 text-text-secondary") %>
        사전오더접수오류 목록
        <%= render Ui::GridActionsComponent.new(grid_id: "om-pre-order-reception-error-master") %>
      </h3>
      <%= render Ui::GridToolbarComponent.new(
        buttons: [
          { label: "재처리", class: "btn btn-sm btn-primary", action: "click->om-pre-order-reception-error#reprocess" },
          { label: "양식다운로드", class: "btn btn-sm btn-secondary", action: "click->om-pre-order-reception-error#downloadTemplate" },
          { label: "오류업로드", class: "btn btn-sm btn-secondary", action: "click->om-pre-order-reception-error#openUploadDialog" }
        ]
      ) %>
    </div>

    <input type="file"
           accept=".csv"
           hidden
           data-om-pre-order-reception-error-target="fileInput"
           data-action="change->om-pre-order-reception-error#uploadFile">

    <%= render Ui::AgGridComponent.new(
      columns: master_columns,
      url: grid_url,
      height: "calc(100vh - 470px)",
      page_size: 20,
      row_selection: "multiple",
      grid_id: "om-pre-order-reception-error-master",
      data: {
        om_pre_order_reception_error_target: "masterGrid",
        action: "ag-grid:ready->om-pre-order-reception-error#registerGrid ag-grid:selectionChanged->om-pre-order-reception-error#handleSelectionChanged"
      }
    ) %>
  </section>

  <section>
    <div class="flex items-center justify-between gap-3 mb-3 mt-2">
      <h3 class="inline-flex items-center gap-2 text-[15px] font-semibold text-text-primary">
        <%= helpers.lucide_icon("list", css_class: "w-4 h-4 text-text-secondary") %>
        사전오더접수오류 상세
        <%= render Ui::GridActionsComponent.new(grid_id: "om-pre-order-reception-error-detail") %>
      </h3>
    </div>

    <%= render Ui::AgGridComponent.new(
      columns: detail_columns,
      row_data: [],
      height: "260px",
      page_size: 20,
      grid_id: "om-pre-order-reception-error-detail",
      data: {
        om_pre_order_reception_error_target: "detailGrid",
        action: "ag-grid:ready->om-pre-order-reception-error#registerGrid"
      }
    ) %>
  </section>
</div>
